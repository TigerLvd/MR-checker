# –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –¥–∏–∞–ª–æ–≥–æ–≤ (DialogApi)

## –û–±—â–∏–π –æ–±–∑–æ—Ä
–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –¥–∏–∞–ª–æ–≥–æ–≤ –º–µ–∂–¥—É –¥—Ä—É–∑—å—è–º–∏ —Å —Å—Ç—Ä–æ–≥–∏–º —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º TDD –ø–æ–¥—Ö–æ–¥—É (Red-Green-Refactor). –ù–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ —Å–Ω–∞—á–∞–ª–∞ –ø–∏—à—É—Ç—Å—è —Ç–µ—Å—Ç—ã, –ø–æ—Ç–æ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –∏—Ö –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è, –∑–∞—Ç–µ–º —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥. –í–∫–ª—é—á–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ë–î, —Å–µ—Ä–≤–∏—Å–æ–≤, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ –ø–æ–ª–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —Å–∏—Å—Ç–µ–º–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

## –ó–∞–¥–∞—á–∏ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ —Ñ–∞–∑–∞–º

### –§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —Ç–µ—Å—Ç—ã (–ë–∞–∑–æ–≤—ã–π —Å–ª–æ–π)

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å SecurityContext**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ SecurityUtils —Å –º–µ—Ç–æ–¥–∞–º–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Ç–æ–∫–µ–Ω–∞
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/util/SecurityUtils.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: SecurityUtils, getCurrentUserId(), getCurrentUser()
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –ù–µ—Ç

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è FriendshipRequiredException**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Å–ª—É—á–∞—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥—Ä—É–∂–±—ã –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/exception/FriendshipRequiredException.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: FriendshipRequiredException extends RuntimeException
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –ù–µ—Ç

[ ] **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ FriendshipRequiredException —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º 403 —Å—Ç–∞—Ç—É—Å–∞
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/exception/ErrorResponseHandler.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @ExceptionHandler –¥–ª—è FriendshipRequiredException, HTTP 403
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ FriendshipRequiredException

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ DialogApiImpl - —Ç–µ—Å—Ç—ã –Ω–∞ 200 OK (Red phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ —Å –º–æ–∫–∞–º–∏, —Ç–µ—Å—Ç—ã –Ω–∞ —É—Å–ø–µ—à–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ 200 OK (—Ç–µ—Å—Ç—ã —É–ø–∞–¥—É—Ç)
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/test/java/com/highload/architect/soc/network/api/DialogApiImplTest.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @SpringBootTest, @MockBean, MockMvc, —Ç–µ—Å—Ç—ã sendMessage –∏ getMessages –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–µ 200
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ SecurityUtils (–¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö)

### –§–∞–∑–∞ 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –ë–î (In-Memory) - TDD —Ü–∏–∫–ª

[ ] **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è DialogApiImpl —Å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ø–∞–º—è—Ç–∏ (Green phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤ 200 OK –∏–∑ –§–∞–∑—ã 1 —Å List –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/api/DialogApiImpl.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: List<DialogMessage>, –º–µ—Ç–æ–¥—ã dialogUserIdSendPost –∏ dialogUserIdListGet, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SecurityUtils
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ (–§–∞–∑–∞ 1)

[ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –±–∞–∑–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ 200 OK –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - –ù–µ—Ç (—Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: DialogApiImplTest
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è DialogApiImpl —Å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ø–∞–º—è—Ç–∏

[ ] **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ—à–∏–±–æ–∫ (Red phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–≥–æ UUID (400), –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (401), –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –¥—Ä—É–∂–±—ã (403)
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/test/java/com/highload/architect/soc/network/api/DialogApiImplTest.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –¢–µ—Å—Ç—ã –¥–ª—è 400, 401, 403 —Å—Ç–∞—Ç—É—Å–æ–≤ (–¥–æ–ª–∂–Ω—ã —É–ø–∞—Å—Ç—å)
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

[ ] **–î–æ—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –æ—à–∏–±–æ—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (Green phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—Ä—É–∂–±—ã (–∑–∞–≥–ª—É—à–∫–∞ –≤—Å–µ–≥–¥–∞ true) –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/api/DialogApiImpl.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –û–±—Ä–∞–±–æ—Ç–∫–∞ IllegalArgumentException, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –º–µ—Ç–æ–¥ checkFriendship (–∑–∞–≥–ª—É—à–∫–∞)
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ—à–∏–±–æ–∫

[ ] **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥: –≤—ã–Ω–æ—Å –ª–æ–≥–∏–∫–∏ –≤ –º–µ—Ç–æ–¥—ã (Refactor phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –£–ª—É—á—à–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–¥–∞ DialogApiImpl, –≤—ã–¥–µ–ª–µ–Ω–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/api/DialogApiImpl.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏, –º–∞–ø–ø–∏–Ω–≥–∞, –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—Ä—É–∂–±—ã
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –î–æ—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –æ—à–∏–±–æ—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

[ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –Ω–µ —Å–ª–æ–º–∞–ª —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - –ù–µ—Ç (—Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: DialogApiImplTest
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

### –§–∞–∑–∞ 3: –°–ª–æ–π –¥–∞–Ω–Ω—ã—Ö (Database Layer)

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã friendship**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: Liquibase changeset –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –¥—Ä—É–∂–µ—Å–∫–∏—Ö —Å–≤—è–∑–µ–π —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/resources/db/changelog/db.changelog-3.0.xml` (—Å–æ–∑–¥–∞–Ω–∏–µ)
  - `src/main/resources/db/changelog/db.changelog-master.xml` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –¢–∞–±–ª–∏—Ü–∞ friendship, –∏–Ω–¥–µ–∫—Å—ã idx_friendship_unique, idx_user_friends, idx_friend
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –ù–µ—Ç

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã dialog_message**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: Liquibase changeset –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/resources/db/changelog/db.changelog-3.0.xml` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –¢–∞–±–ª–∏—Ü–∞ dialog_message, –∏–Ω–¥–µ–∫—Å—ã idx_dialog_users, idx_to_user, idx_from_user
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã friendship

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ Entity –º–æ–¥–µ–ª–∏ Friendship**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: JPA Entity –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–∂–µ—Å–∫–∏—Ö —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/model/Friendship.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @Entity Friendship, –ø–æ–ª—è id, userId, friendId, createdAt
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã friendship

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ Entity –º–æ–¥–µ–ª–∏ DialogMessageEntity**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: JPA Entity –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ë–î (–æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç DTO DialogMessage)
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/model/DialogMessageEntity.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @Entity DialogMessageEntity, –ø–æ–ª—è id, fromUserId, toUserId, text, createdAt
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã dialog_message

### –§–∞–∑–∞ 4: –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (Repository Layer) - TDD —Ü–∏–∫–ª

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è DialogMessageRepository (Red phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è, –ø–æ–∏—Å–∫–∞ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç–µ—Å—Ç—ã —É–ø–∞–¥—É—Ç)
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/test/java/com/highload/architect/soc/network/repository/DialogMessageRepositoryTest.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @DataJpaTest, —Ç–µ—Å—Ç—ã save, findByUsersPaged, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ Entity –º–æ–¥–µ–ª–∏ DialogMessageEntity

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ DialogMessageRepository (Green phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: Spring Data JPA Repository —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/repository/DialogMessageRepository.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: Interface extends JpaRepository, –º–µ—Ç–æ–¥ findByUsersPaged —Å @Query –∏ Pageable
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è DialogMessageRepository

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ FriendshipRepository**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: Spring Data JPA Repository –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥—Ä—É–∂–µ—Å–∫–∏–º–∏ —Å–≤—è–∑—è–º–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/repository/FriendshipRepository.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: Interface extends JpaRepository, –º–µ—Ç–æ–¥ existsByUserIdAndFriendId
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ Entity –º–æ–¥–µ–ª–∏ Friendship

### –§–∞–∑–∞ 5: –ú–∞–ø–ø–∏–Ω–≥ (Mapper Layer)

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ DialogMessageMapper**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: Mapper –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –º–µ–∂–¥—É DialogMessageEntity –∏ DialogMessage (DTO)
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/mapper/DialogMessageMapper.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @Component DialogMessageMapper, –º–µ—Ç–æ–¥—ã toDto, toEntity
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ DialogMessageEntity
- –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ú–∞–ø–ø–µ—Ä –º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ unit-—Ç–µ—Å—Ç—ã

### –§–∞–∑–∞ 6: –°–µ—Ä–≤–∏—Å—ã (Service Layer) - TDD —Ü–∏–∫–ª

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ FriendService**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥—Ä—É–∑—å—è–º–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/service/FriendService.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: Interface FriendService, –º–µ—Ç–æ–¥—ã areFriends, addFriend, removeFriend
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –ù–µ—Ç

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ FriendServiceImpl (Red phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ù–∞–ø–∏—Å–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ —Å –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (—Ç–µ—Å—Ç—ã —É–ø–∞–¥—É—Ç)
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/test/java/com/highload/architect/soc/network/service/impl/FriendServiceImplTest.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @ExtendWith(MockitoExtension), @Mock FriendshipRepository, —Ç–µ—Å—Ç—ã areFriends –¥–ª—è –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π –¥—Ä—É–∂–±—ã
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ FriendService

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ FriendServiceImpl (Green phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FriendshipRepository
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/service/impl/FriendServiceImpl.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @Service FriendServiceImpl, –º–µ—Ç–æ–¥ areFriends –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—é—é –¥—Ä—É–∂–±—É
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ FriendServiceImpl, —Å–æ–∑–¥–∞–Ω–∏–µ FriendshipRepository

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ DialogService**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∏–∞–ª–æ–≥–∞–º–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/service/DialogService.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: Interface DialogService, –º–µ—Ç–æ–¥—ã sendMessage, getDialogMessages —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –ù–µ—Ç

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ DialogServiceImpl (Red phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ù–∞–ø–∏—Å–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏, –ø–æ–ª—É—á–µ–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—Ä—É–∂–±—ã (—Ç–µ—Å—Ç—ã —É–ø–∞–¥—É—Ç)
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/test/java/com/highload/architect/soc/network/service/impl/DialogServiceImplTest.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @ExtendWith(MockitoExtension), –º–æ–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ FriendService, —Ç–µ—Å—Ç—ã –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ DialogService

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ DialogServiceImpl (Green phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥—Ä—É–∂–±—ã, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/service/impl/DialogServiceImpl.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @Service DialogServiceImpl, –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ DialogMessageRepository, FriendService, DialogMessageMapper
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ DialogServiceImpl, —Å–æ–∑–¥–∞–Ω–∏–µ DialogMessageRepository, FriendServiceImpl, DialogMessageMapper

### –§–∞–∑–∞ 7: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API (Controller Layer) - TDD —Ü–∏–∫–ª

[ ] **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ DialogApiImpl –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è DialogService (Green phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ó–∞–º–µ–Ω–∞ in-memory —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ –≤—ã–∑–æ–≤—ã DialogService –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/api/DialogApiImpl.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ DialogService, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SecurityUtils, –æ–±—Ä–∞–±–æ—Ç–∫–∞ FriendshipRequiredException
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ DialogServiceImpl, —Å–æ–∑–¥–∞–Ω–∏–µ SecurityUtils

[ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–µ—Ä–≤–∏—Å–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - –ù–µ—Ç (—Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: DialogApiImplTest
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ DialogApiImpl –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è DialogService

[ ] **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (Red phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ page/size (—Ç–µ—Å—Ç—ã —É–ø–∞–¥—É—Ç)
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/test/java/com/highload/architect/soc/network/api/DialogApiImplTest.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –¢–µ—Å—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π page/size, –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—è–¥–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

[ ] **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ DialogApiImpl (Green phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ page –∏ size –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/api/DialogApiImpl.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
  - `src/main/java/com/highload/architect/soc/network/api/DialogApi.java` (–∞–Ω–∞–ª–∏–∑, –≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @RequestParam page –∏ size, –ø–µ—Ä–µ–¥–∞—á–∞ –≤ DialogService
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

[ ] **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –∏ –º–æ–∫–∞–º–∏ —Ç–æ–ª—å–∫–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/test/java/com/highload/architect/soc/network/api/DialogApiImplTest.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –ó–∞–º–µ–Ω–∞ –º–æ–∫–æ–≤ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã, –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ DialogApiImpl

### –§–∞–∑–∞ 8: –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–∑—å—è–º–∏ (FriendApi) - TDD —Ü–∏–∫–ª

[ ] **–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ FriendApiImpl (Red phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –¥—Ä—É–∑–µ–π (—Ç–µ—Å—Ç—ã —É–ø–∞–¥—É—Ç)
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/test/java/com/highload/architect/soc/network/api/FriendApiImplTest.java` (—Å–æ–∑–¥–∞–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @SpringBootTest, MockMvc, —Ç–µ—Å—Ç—ã —É—Å–ø–µ—à–Ω—ã—Ö –∏ –æ—à–∏–±–æ—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –¥–ª—è –æ–±–æ–∏—Ö –º–µ—Ç–æ–¥–æ–≤
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ FriendServiceImpl

[ ] **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ FriendApiImpl –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–∑–µ–π (Green phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–≥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FriendService –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/api/FriendApiImpl.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ FriendService, –º–µ—Ç–æ–¥ friendSetUserIdPut, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SecurityUtils
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ FriendApiImpl

[ ] **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ FriendApiImpl –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥—Ä—É–∑–µ–π (Green phase)**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥—Ä—É–≥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FriendService –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/api/FriendApiImpl.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –ú–µ—Ç–æ–¥ friendDeleteUserIdPut, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FriendService
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ FriendApiImpl –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–∑–µ–π

[ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ FriendApi**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - –ù–µ—Ç (—Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: FriendApiImplTest
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ FriendApiImpl –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥—Ä—É–∑–µ–π

### –§–∞–∑–∞ 9: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

[ ] **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –í–∞–ª–∏–¥–∞—Ü–∏—è page >= 0, 0 < size <= 100 —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º 400 –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/api/DialogApiImpl.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, BadRequestException
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ DialogApiImpl

[ ] **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Å–µ—Ä–≤–∏—Å—ã**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ debug –∏ info –ª–æ–≥–æ–≤ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/service/impl/DialogServiceImpl.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
  - `src/main/java/com/highload/architect/soc/network/service/impl/FriendServiceImpl.java` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: Logger, log.debug, log.info, log.error
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ DialogServiceImpl –∏ FriendServiceImpl

[ ] **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQL –∑–∞–ø—Ä–æ—Å–æ–≤**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ê–Ω–∞–ª–∏–∑ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - `src/main/java/com/highload/architect/soc/network/repository/DialogMessageRepository.java` (–≤–æ–∑–º–æ–∂–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: @Query –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏, –∞–Ω–∞–ª–∏–∑ EXPLAIN ANALYZE
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –°–æ–∑–¥–∞–Ω–∏–µ DialogMessageRepository

[ ] **–ò—Ç–æ–≥–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è**
- –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏
- –ü–µ—Ä–µ—á–µ–Ω—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤:
  - –í—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã (–≤–æ–∑–º–æ–∂–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
- –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: JUnit —Ç–µ—Å—Ç—ã, coverage report
- –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∑–∞–¥–∞—á–∏

## –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ production

- [ ] –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –ë–î —Å–æ–∑–¥–∞–Ω—ã —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏
- [ ] –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
- [ ] –í—Å–µ unit-—Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
- [ ] –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
- [ ] –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏ >= 80%
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä—É–∂–±—ã —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Ç–æ–∫–µ–Ω—ã —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π (–æ—Ç –Ω–æ–≤—ã—Ö –∫ —Å—Ç–∞—Ä—ã–º)
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- [ ] SQL –∑–∞–ø—Ä–æ—Å—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –ù–µ—Ç N+1 –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏
- [ ] –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –ø—Ä–æ–µ–∫—Ç–∞
- [ ] –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç linter –æ—à–∏–±–∫–∏
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
- [ ] –¢–µ—Å—Ç—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç —Å H2/PostgreSQL

## –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—É—Ç—å (–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å TDD):

**–§–∞–∑–∞ 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**
1. –°–æ–∑–¥–∞–Ω–∏–µ —É—Ç–∏–ª–∏—Ç—ã SecurityUtils
2. –°–æ–∑–¥–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è FriendshipRequiredException
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
4. üî¥ **Red:** –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ DialogApiImpl (200 OK)

**–§–∞–∑–∞ 2: In-Memory TDD —Ü–∏–∫–ª**
5. üü¢ **Green:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è DialogApiImpl —Å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ø–∞–º—è—Ç–∏ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –∏–∑ –ø.4
6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
7. üî¥ **Red:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –æ—à–∏–±–æ–∫ (400, 401, 403)
8. üü¢ **Green:** –î–æ—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –æ—à–∏–±–æ–∫
9. üîµ **Refactor:** –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ DialogApiImpl
10. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

**–§–∞–∑–∞ 3: Database**
11. –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î (friendship –∏ dialog_message)
12. –°–æ–∑–¥–∞–Ω–∏–µ Entity –º–æ–¥–µ–ª–µ–π (Friendship, DialogMessageEntity)

**–§–∞–∑–∞ 4: Repository TDD —Ü–∏–∫–ª**
13. üî¥ **Red:** –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è DialogMessageRepository
14. üü¢ **Green:** –°–æ–∑–¥–∞–Ω–∏–µ DialogMessageRepository –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
15. –°–æ–∑–¥–∞–Ω–∏–µ FriendshipRepository

**–§–∞–∑–∞ 5: Mapper**
16. –°–æ–∑–¥–∞–Ω–∏–µ –º–∞–ø–ø–µ—Ä–∞ DialogMessageMapper

**–§–∞–∑–∞ 6: Services TDD —Ü–∏–∫–ª**
17. –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ FriendService
18. üî¥ **Red:** –°–æ–∑–¥–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ FriendServiceImpl
19. üü¢ **Green:** –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ FriendServiceImpl –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
20. –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ DialogService
21. üî¥ **Red:** –°–æ–∑–¥–∞–Ω–∏–µ unit-—Ç–µ—Å—Ç–æ–≤ DialogServiceImpl
22. üü¢ **Green:** –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ DialogServiceImpl –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

**–§–∞–∑–∞ 7: Integration TDD —Ü–∏–∫–ª**
23. üü¢ **Green:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è DialogService —Å DialogApiImpl (–¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤)
24. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
25. üî¥ **Red:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
26. üü¢ **Green:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ –≤ DialogApiImpl
27. üîµ **Refactor:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

**–§–∞–∑–∞ 8: FriendApi TDD —Ü–∏–∫–ª**
28. üî¥ **Red:** –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ FriendApiImpl
29. üü¢ **Green:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥—Ä—É–∑–µ–π
30. üü¢ **Green:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –¥—Ä—É–∑–µ–π
31. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ FriendApi

**–§–∞–∑–∞ 9: –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è**
32. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
33. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Å–µ—Ä–≤–∏—Å—ã
34. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQL –∑–∞–ø—Ä–æ—Å–æ–≤
35. –ò—Ç–æ–≥–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è

**–£—Å–ª–æ–≤–Ω—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è:**
- üî¥ **Red** - –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ (—Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç)
- üü¢ **Green** - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Ç–µ—Å—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç)
- üîµ **Refactor** - —É–ª—É—á—à–µ–Ω–∏–µ –∫–æ–¥–∞ (—Ç–µ—Å—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
1. **–§–∞–∑–∞ 1** ‚Üí –ø–æ–ª–Ω–æ—Å—Ç—å—é (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã + –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã)
2. **–§–∞–∑–∞ 2** ‚Üí –ø–æ–ª–Ω–æ—Å—Ç—å—é (in-memory —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: Red‚ÜíGreen‚ÜíRefactor —Ü–∏–∫–ª)
3. **–§–∞–∑–∞ 3** ‚Üí –ø–æ–ª–Ω–æ—Å—Ç—å—é (—Å–æ–∑–¥–∞–Ω–∏–µ –ë–î —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ Entity)
4. **–§–∞–∑–∞ 4** ‚Üí –ø–æ–ª–Ω–æ—Å—Ç—å—é (—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏: Red‚ÜíGreen —Ü–∏–∫–ª)
5. **–§–∞–∑–∞ 5** ‚Üí –ø–æ–ª–Ω–æ—Å—Ç—å—é (–º–∞–ø–ø–∏–Ω–≥ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö)
6. **–§–∞–∑–∞ 6** ‚Üí –ø–æ–ª–Ω–æ—Å—Ç—å—é (—Å–µ—Ä–≤–∏—Å—ã: Red‚ÜíGreen —Ü–∏–∫–ª—ã –¥–ª—è FriendService –∏ DialogService)
7. **–§–∞–∑–∞ 7** ‚Üí –ø–æ–ª–Ω–æ—Å—Ç—å—é (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API: Green‚ÜíRed‚ÜíGreen —Ü–∏–∫–ª —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π)
8. **–§–∞–∑–∞ 8** ‚Üí –ø–æ–ª–Ω–æ—Å—Ç—å—é (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—Ä—É–∑—å—è–º–∏: Red‚ÜíGreen —Ü–∏–∫–ª)
9. **–§–∞–∑–∞ 9** ‚Üí –ø–æ–ª–Ω–æ—Å—Ç—å—é (—Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è: –≤–∞–ª–∏–¥–∞—Ü–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)

**–í–∞–∂–Ω–æ:** –ö–∞–∂–¥–∞—è —Ñ–∞–∑–∞ —Å–ª–µ–¥—É–µ—Ç TDD –ø–æ–¥—Ö–æ–¥—É - —Å–Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç—ã (Red), –ø–æ—Ç–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (Green), –∑–∞—Ç–µ–º —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (Refactor)

### –ó–∞–¥–∞—á–∏ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∫ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é:

**–ë–ª–æ–∫ 1 (–§–∞–∑–∞ 1):**
- –°–æ–∑–¥–∞–Ω–∏–µ SecurityUtils
- –°–æ–∑–¥–∞–Ω–∏–µ FriendshipRequiredException
(–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç FriendshipRequiredException)

**–ë–ª–æ–∫ 2 (–§–∞–∑–∞ 3):**
- –°–æ–∑–¥–∞–Ω–∏–µ Entity –º–æ–¥–µ–ª–∏ Friendship
- –°–æ–∑–¥–∞–Ω–∏–µ Entity –º–æ–¥–µ–ª–∏ DialogMessageEntity
(–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π, –º–æ–∂–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)

**–ë–ª–æ–∫ 3 (–§–∞–∑–∞ 4):**
- –¢–µ—Å—Ç—ã DialogMessageRepository –∏ —Å–∞–º DialogMessageRepository –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (TDD)
- FriendshipRepository –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è DialogMessageRepository
(DialogMessageRepository —Å–ª–µ–¥—É–µ—Ç TDD, FriendshipRepository - –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

**–ë–ª–æ–∫ 4 (–§–∞–∑–∞ 6 - —á–∞—Å—Ç–∏—á–Ω–æ):**
- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ FriendService
- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ DialogService
(–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã, –Ω–æ —Ç–µ—Å—Ç—ã –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞)

**–ë–ª–æ–∫ 5 (–§–∞–∑–∞ 8):**
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ FriendApiImpl –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –¥—Ä—É–∑–µ–π –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
(–ù–æ –≤ —Ä–∞–º–∫–∞—Ö TDD –ª—É—á—à–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ: Red‚ÜíGreen –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è, –ø–æ—Ç–æ–º Red‚ÜíGreen –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è)

**–ë–ª–æ–∫ 6 (–§–∞–∑–∞ 9):**
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Å–µ—Ä–≤–∏—Å—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SQL –∑–∞–ø—Ä–æ—Å–æ–≤
(–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é)

## –†–∏—Å–∫–∏

### –†–∏—Å–∫ 1: –ü—Ä–æ–±–ª–µ–º—ã —Å –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π –¥—Ä—É–∂–±–æ–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–ª–æ–∂–Ω–æ—Å—Ç—å –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥—Ä—É–∂–±—ã - –Ω—É–∂–Ω—ã –ª–∏ –¥–≤–µ –∑–∞–ø–∏—Å–∏ (A->B –∏ B->A) –∏–ª–∏ –æ–¥–Ω–∞
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–í–ª–∏—è–Ω–∏–µ:** –í—ã—Å–æ–∫–æ–µ (–≤–ª–∏—è–µ—Ç –Ω–∞ –≤—Å—é –ª–æ–≥–∏–∫—É)
**–†–µ—à–µ–Ω–∏–µ:** 
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤ –Ω–∞—á–∞–ª–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—é—é –º–æ–¥–µ–ª—å (–¥–≤–µ –∑–∞–ø–∏—Å–∏)
- –°–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –Ω–∞ (user_id, friend_id)
- –í –º–µ—Ç–æ–¥–µ areFriends –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ–±–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –†–∏—Å–∫ 2: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ó–∞–ø—Ä–æ—Å—ã –∫ –¥–∏–∞–ª–æ–≥–∞–º –º–æ–≥—É—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å–æ–æ–±—â–µ–Ω–∏–π
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–í–ª–∏—è–Ω–∏–µ:** –°—Ä–µ–¥–Ω–µ–µ
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã (from_user_id, to_user_id, created_at)
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º size <= 100
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö
- –í–æ–∑–º–æ–∂–Ω–æ–µ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (future)

### –†–∏—Å–∫ 3: –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å SecurityContext
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Ç–æ–∫–µ–Ω–∞
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è
**–í–ª–∏—è–Ω–∏–µ:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ (–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞)
**–†–µ—à–µ–Ω–∏–µ:**
- –¢—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SecurityUtils
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ª—É—á–∞–µ–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º SecurityContext

### –†–∏—Å–∫ 4: –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –º–∏–≥—Ä–∞—Ü–∏–π —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
**–û–ø–∏—Å–∞–Ω–∏–µ:** Liquibase –º–∏–≥—Ä–∞—Ü–∏–∏ –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ë–î
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è
**–í–ª–∏—è–Ω–∏–µ:** –í—ã—Å–æ–∫–æ–µ
**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ preConditions –≤ changesets
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –Ω–∞ –∫–æ–ø–∏–∏ production –ë–î
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏–π

### –†–∏—Å–∫ 5: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–ø—É—Å–∫ edge cases –≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–í–ª–∏—è–Ω–∏–µ:** –°—Ä–µ–¥–Ω–µ–µ
**–†–µ—à–µ–Ω–∏–µ:**
- –°—Ç—Ä–æ–≥–æ–µ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ TDD –ø–æ–¥—Ö–æ–¥—É
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
- Code review —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ coverage –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

### –†–∏—Å–∫ 6: –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ @Transactional –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ inconsistency
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–í–ª–∏—è–Ω–∏–µ:** –í—ã—Å–æ–∫–æ–µ
**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ @Transactional –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–≤–∏—Å–æ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ rollback —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

### –†–∏—Å–∫ 7: N+1 –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
**–û–ø–∏—Å–∞–Ω–∏–µ:** –í–æ–∑–º–æ–∂–Ω—ã–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–í–ª–∏—è–Ω–∏–µ:** –°—Ä–µ–¥–Ω–µ–µ (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ JOIN FETCH –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
- –ê–Ω–∞–ª–∏–∑ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö SQL —á–µ—Ä–µ–∑ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

### –†–∏—Å–∫ 8: –ü—Ä–æ–±–ª–µ–º—ã —Å —á–∞—Å–æ–≤—ã–º–∏ –ø–æ—è—Å–∞–º–∏
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ (created_at)
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è
**–í–ª–∏—è–Ω–∏–µ:** –°—Ä–µ–¥–Ω–µ–µ
**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ UTC –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î
- LocalDateTime –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
- –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ —Ç–∏–ø–∞ TIMESTAMP –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö

